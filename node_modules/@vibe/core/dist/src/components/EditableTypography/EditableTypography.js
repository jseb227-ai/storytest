import{slicedToArray as e,defineProperty as t}from"../../../_virtual/_rollupPluginBabelHelpers.js";import o,{forwardRef as n,useRef as l,useState as r,useEffect as a}from"react";import i from"classnames";import s from"../../hooks/useMergeRef.js";import u from"./EditableTypography.module.scss.js";import{keyCodes as c}from"../../constants/keyCodes.js";import"../../constants/sizes.js";import{useKeyboardButtonPressedFunc as p}from"../../hooks/useKeyboardButtonPressedFunc.js";import d from"../../hooks/usePrevious/index.js";import f from"../../hooks/ssr/useIsomorphicLayoutEffect.js";var m=n((function(n,m){var v=n.id,h=n.className,y=n["data-testid"],g=n.value,E=n.onChange,b=n.onClick,P=n.readOnly,C=void 0!==P&&P,x=n.ariaLabel,k=void 0===x?"":x,j=n.placeholder,w=n.clearable,N=n.typographyClassName,D=n.component,B=n.isEditMode,K=n.autoSelectTextOnEditMode,T=n.onEditModeChange,M=n.tooltipProps,R=n.type,S=n.weight,A=n.multiline,H=void 0!==A&&A,I=l(null),L=s(m,I),O=r(B||!1),_=e(O,2),z=_[0],F=_[1],q=r(g),G=e(q,2),J=G[0],Q=G[1],U=d(g),V=l(null),W=l(null);function X(e){C||z||(e.preventDefault(),Y(!0))}function Y(e){null==T||T(e),F(e)}function Z(){(Y(!1),g!==J)&&(J||w&&j?(Q(J),null==E||E(J)):Q(g))}function $(){Z()}function ee(e){if(!e.nativeEvent.isComposing){if(e.key===c.ENTER){if(H&&e.shiftKey)return;e.preventDefault(),e.stopPropagation(),Z()}e.key===c.ESCAPE&&(e.preventDefault(),e.stopPropagation(),Y(!1),Q(g))}}function te(e){Q(e.target.value)}a((function(){z||g===U||g===J||Q(g)}),[U,z,g,J]),a((function(){F(B)}),[B]);var oe=p(X);return a((function(){var e,t;z&&(!function(){var e,t;if(null===(t=null===(e=V.current)||void 0===e?void 0:e.focus)||void 0===t||t.call(e),V.current){var o=V.current,n=o.value.length;o.setSelectionRange(n,n)}}(),K&&(null===(t=null===(e=V.current)||void 0===e?void 0:e.select)||void 0===t||t.call(e)))}),[K,z]),f((function(){var e;if(W.current){var t=W.current.getBoundingClientRect();if(null===(e=null==V?void 0:V.current)||void 0===e||e.style.setProperty("--input-width","".concat(t.width,"px")),H){var o=null==V?void 0:V.current;null==o||o.style.setProperty("--input-height","auto"),null==o||o.style.setProperty("--input-height","".concat(o.scrollHeight+2,"px"))}}}),[J,z]),o.createElement("div",{ref:L,id:v,"aria-label":k,"data-testid":y,className:i(u.editableTypography,h),role:z?null:"button",onClick:function(e){null==b||b(e),X(e)},onKeyDown:oe},z&&(H?o.createElement("textarea",{ref:V,className:i(u.textarea,N),value:J,onChange:te,onKeyDown:ee,onBlur:$,"aria-label":k,placeholder:j,role:"textbox",rows:1}):o.createElement("input",{ref:V,className:i(u.input,N),value:J,onChange:te,onKeyDown:ee,onBlur:$,"aria-label":k,placeholder:j,role:"input"})),o.createElement(D,{ref:W,"aria-hidden":z,className:i(u.typography,N,t(t(t(t({},u.hidden,z),u.disabled,C),u.placeholder,!J&&j),u.multiline,!z&&H)),tabIndex:0,tooltipProps:M,weight:S,type:R,ellipsis:!H},J||j))}));export{m as default};
//# sourceMappingURL=EditableTypography.js.map

{"version":3,"file":"useDropdownSelect.js","sources":["../../../../../src/components/DropdownNew/hooks/useDropdownSelect.ts"],"sourcesContent":["import { useMemo, useState } from \"react\";\nimport { useSelect } from \"downshift\";\nimport useDropdownFiltering from \"./useDropdownFiltering\";\nimport { type BaseListItemData } from \"../../BaseListItem\";\nimport { type DropdownGroupOption } from \"../Dropdown.types\";\n\nfunction useDropdownSelect<T extends BaseListItemData<Record<string, unknown>>>(\n  options: DropdownGroupOption<T>,\n  autoFocus?: boolean,\n  isMenuOpen?: boolean,\n  defaultValue?: T,\n  value?: T,\n  onChange?: (option: T | T[] | null) => void,\n  onMenuOpen?: () => void,\n  onMenuClose?: () => void,\n  onOptionSelect?: (option: T) => void,\n  showSelectedOptions?: boolean,\n  filterOption?: (option: T, inputValue: string) => boolean\n) {\n  const [currentSelectedItem, setCurrentSelectedItem] = useState<T | null>(defaultValue || null);\n\n  const selectedItem = value !== undefined ? value : currentSelectedItem;\n\n  const memoizedSelectedItemForFiltering = useMemo(() => {\n    return selectedItem ? [selectedItem] : [];\n  }, [selectedItem]);\n\n  const { filteredOptions } = useDropdownFiltering<T>(\n    options,\n    filterOption,\n    showSelectedOptions,\n    memoizedSelectedItemForFiltering\n  );\n\n  const flatOptions = useMemo(() => filteredOptions.flatMap(group => group.options), [filteredOptions]);\n\n  const {\n    isOpen,\n    highlightedIndex,\n    getToggleButtonProps,\n    getLabelProps,\n    getMenuProps,\n    getItemProps,\n    reset: downshiftReset,\n    openMenu,\n    toggleMenu,\n    closeMenu\n  } = useSelect<T>({\n    items: flatOptions,\n    itemToString: item => item?.label ?? \"\",\n    isItemDisabled: item => Boolean(item.disabled),\n    isOpen: isMenuOpen,\n    initialIsOpen: autoFocus,\n    selectedItem: selectedItem,\n    onSelectedItemChange: ({ selectedItem: newSelectedItem }) => {\n      if (value === undefined) {\n        setCurrentSelectedItem(newSelectedItem || null);\n      }\n      if (newSelectedItem) {\n        onOptionSelect?.(newSelectedItem);\n      }\n      onChange?.(newSelectedItem || null);\n    },\n    onIsOpenChange: ({ isOpen }) => {\n      isOpen ? onMenuOpen?.() : onMenuClose?.();\n    }\n  });\n\n  const reset = () => {\n    if (value === undefined) {\n      setCurrentSelectedItem(null);\n    }\n    downshiftReset();\n    onChange?.(null);\n  };\n\n  const getInputProps = () => ({});\n\n  return {\n    isOpen,\n    inputValue: \"\",\n    highlightedIndex,\n    selectedItem,\n    getToggleButtonProps,\n    getLabelProps,\n    getMenuProps,\n    getInputProps,\n    getItemProps,\n    reset,\n    filteredOptions,\n    openMenu,\n    toggleMenu,\n    closeMenu\n  };\n}\n\nexport default useDropdownSelect;\n"],"names":["useDropdownSelect","options","autoFocus","isMenuOpen","defaultValue","value","onChange","onMenuOpen","onMenuClose","onOptionSelect","showSelectedOptions","filterOption","_useState","useState","_useState2","_slicedToArray","setCurrentSelectedItem","selectedItem","undefined","memoizedSelectedItemForFiltering","useMemo","filteredOptions","useDropdownFiltering","flatOptions","flatMap","group","_useSelect","useSelect","items","itemToString","item","_a","label","isItemDisabled","disabled","isOpen","initialIsOpen","onSelectedItemChange","_ref","newSelectedItem","onIsOpenChange","_ref2","downshiftReset","reset","inputValue","highlightedIndex","getToggleButtonProps","getLabelProps","getMenuProps","getInputProps","getItemProps","openMenu","toggleMenu","closeMenu"],"mappings":"+MAMA,SAASA,EACPC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAEA,IAAAC,EAAsDC,EAAmBT,GAAgB,MAAKU,EAAAC,EAAAH,EAAA,GAAlEI,EAAsBF,EAAA,GAE5CG,OAAyBC,IAAVb,EAAsBA,EAFjBS,EAAA,GAIpBK,EAAmCC,GAAQ,WAC/C,OAAOH,EAAe,CAACA,GAAgB,EACzC,GAAG,CAACA,IAEII,EAAoBC,EAC1BrB,EACAU,EACAD,EACAS,GAJME,gBAOFE,EAAcH,GAAQ,WAAA,OAAMC,EAAgBG,SAAQ,SAAAC,GAAK,OAAIA,EAAMxB,aAAU,CAACoB,IAEpFK,EAWIC,EAAa,CACfC,MAAOL,EACPM,aAAc,SAAAC,GAAO,IAAAC,EAAC,OAAe,QAAfA,EAAAD,eAAAA,EAAME,aAAS,IAAAD,EAAAA,EAAA,EAAE,EACvCE,eAAgB,SAAAH,GAAI,QAAYA,EAAKI,QAAS,EAC9CC,OAAQhC,EACRiC,cAAelC,EACfe,aAAcA,EACdoB,qBAAsB,SAAAC,GAAsC,IAArBC,EAAeD,EAA7BrB,kBACTC,IAAVb,GACFW,EAAuBuB,GAAmB,MAExCA,IACF9B,SAAAA,EAAiB8B,IAEnBjC,SAAAA,EAAWiC,GAAmB,KAC/B,EACDC,eAAgB,SAAAC,GAASA,EAANN,OACR5B,SAAAA,IAAiBC,SAAAA,GAC5B,IAtBOkC,EAAchB,EAArBiB,MAmCF,MAAO,CACLR,OA1CMT,EAANS,OA2CAS,WAAY,GACZC,iBA3CgBnB,EAAhBmB,iBA4CA5B,aAAAA,EACA6B,qBA5CoBpB,EAApBoB,qBA6CAC,cA5CarB,EAAbqB,cA6CAC,aA5CYtB,EAAZsB,aA6CAC,cAVoB,WAAH,MAAU,IAW3BC,aA7CYxB,EAAZwB,aA8CAP,MApBY,gBACEzB,IAAVb,GACFW,EAAuB,MAEzB0B,IACApC,SAAAA,EAAW,OAgBXe,gBAAAA,EACA8B,SA9CQzB,EAARyB,SA+CAC,WA9CU1B,EAAV0B,WA+CAC,UA9CS3B,EAAT2B,UAgDJ"}
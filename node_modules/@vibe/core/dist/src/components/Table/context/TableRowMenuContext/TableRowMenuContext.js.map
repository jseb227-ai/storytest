{"version":3,"file":"TableRowMenuContext.js","sources":["../../../../../../src/components/Table/context/TableRowMenuContext/TableRowMenuContext.tsx"],"sourcesContent":["import React, { createContext, useCallback, useContext, useMemo, useRef, useState } from \"react\";\nimport {\n  type TableRowMenuContext as ITableRowMenuContext,\n  type TableRowMenuProviderProps\n} from \"./TableRowMenuContext.types\";\n\nconst TableRowMenuContext = createContext<ITableRowMenuContext | undefined>(undefined);\n\nexport const TableRowMenuProvider = ({ value, children }: TableRowMenuProviderProps) => {\n  const { tableRootRef, hoveredRowRef, isMenuOpen, resetHoveredRow, setHoveredRowRef, setIsMenuOpen } = value;\n  const [menuButtonPosition, setMenuButtonPosition] = useState(0);\n  const isMenuHovered = useRef(false);\n\n  const onMouseOverRow = useCallback(\n    (rowRef: React.RefObject<HTMLDivElement>) => {\n      if (isMenuOpen) return;\n\n      setHoveredRowRef(rowRef);\n      const tableRootTop = tableRootRef.current.getBoundingClientRect().top;\n      const rowTop = rowRef.current.getBoundingClientRect().top;\n      setMenuButtonPosition(rowTop - tableRootTop);\n    },\n    [isMenuOpen, setHoveredRowRef, tableRootRef]\n  );\n\n  const onMouseLeaveRow = useCallback(() => {\n    if (isMenuOpen || isMenuHovered.current) return;\n    setHoveredRowRef(null);\n  }, [isMenuOpen, setHoveredRowRef]);\n\n  const onMouseOverRowMenu = useCallback(() => {\n    isMenuHovered.current = true;\n  }, []);\n\n  const onMouseLeaveRowMenu = useCallback(() => {\n    isMenuHovered.current = false;\n    if (isMenuOpen) return;\n\n    if (!hoveredRowRef?.current) {\n      setHoveredRowRef(null);\n    }\n  }, [isMenuOpen, hoveredRowRef, setHoveredRowRef]);\n\n  const setTableMenuShown = useCallback(() => {\n    setIsMenuOpen(true);\n  }, [setIsMenuOpen]);\n\n  const setTableMenuHidden = useCallback(() => {\n    setIsMenuOpen(false);\n  }, [setIsMenuOpen]);\n\n  const contextValue = useMemo<ITableRowMenuContext>(\n    () => ({\n      hoveredRowId: hoveredRowRef?.current?.id,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseOverRow,\n      onMouseLeaveRow,\n      onMouseOverRowMenu,\n      onMouseLeaveRowMenu,\n      setTableMenuShown,\n      setTableMenuHidden\n    }),\n    [\n      hoveredRowRef,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseLeaveRow,\n      onMouseLeaveRowMenu,\n      onMouseOverRow,\n      onMouseOverRowMenu,\n      setTableMenuShown,\n      setTableMenuHidden\n    ]\n  );\n\n  return <TableRowMenuContext.Provider value={contextValue}>{children}</TableRowMenuContext.Provider>;\n};\n\nexport const useTableRowMenu = () => {\n  const context = useContext(TableRowMenuContext);\n  if (!context) {\n    throw new Error(\"useTableRowMenuContext must be used within a TableRowMenuProvider\");\n  }\n  return context;\n};\n"],"names":["TableRowMenuContext","createContext","undefined","TableRowMenuProvider","_ref","value","children","tableRootRef","hoveredRowRef","isMenuOpen","resetHoveredRow","setHoveredRowRef","setIsMenuOpen","_useState","useState","_useState2","_slicedToArray","menuButtonPosition","setMenuButtonPosition","isMenuHovered","useRef","onMouseOverRow","useCallback","rowRef","tableRootTop","current","getBoundingClientRect","top","rowTop","onMouseLeaveRow","onMouseOverRowMenu","onMouseLeaveRowMenu","setTableMenuShown","setTableMenuHidden","contextValue","useMemo","hoveredRowId","_a","id","React","createElement","Provider","useTableRowMenu","context","useContext","Error"],"mappings":"sMAMA,IAAMA,EAAsBC,OAAgDC,GAE/DC,EAAuB,SAAHC,GAAsD,IAAhDC,EAAKD,EAALC,MAAOC,EAAQF,EAARE,SACpCC,EAA8FF,EAA9FE,aAAcC,EAAgFH,EAAhFG,cAAeC,EAAiEJ,EAAjEI,WAAYC,EAAqDL,EAArDK,gBAAiBC,EAAoCN,EAApCM,iBAAkBC,EAAkBP,EAAlBO,cACpFC,EAAoDC,EAAS,GAAEC,EAAAC,EAAAH,EAAA,GAAxDI,EAAkBF,EAAA,GAAEG,EAAqBH,EAAA,GAC1CI,EAAgBC,GAAO,GAEvBC,EAAiBC,GACrB,SAACC,GACC,IAAId,EAAJ,CAEAE,EAAiBY,GACjB,IAAMC,EAAejB,EAAakB,QAAQC,wBAAwBC,IAC5DC,EAASL,EAAOE,QAAQC,wBAAwBC,IACtDT,EAAsBU,EAASJ,EALf,CAMjB,GACD,CAACf,EAAYE,EAAkBJ,IAG3BsB,EAAkBP,GAAY,WAC9Bb,GAAcU,EAAcM,SAChCd,EAAiB,KACnB,GAAG,CAACF,EAAYE,IAEVmB,EAAqBR,GAAY,WACrCH,EAAcM,SAAU,CACzB,GAAE,IAEGM,EAAsBT,GAAY,WACtCH,EAAcM,SAAU,EACpBhB,IAECD,eAAAA,EAAeiB,UAClBd,EAAiB,KAEpB,GAAE,CAACF,EAAYD,EAAeG,IAEzBqB,EAAoBV,GAAY,WACpCV,GAAc,EAChB,GAAG,CAACA,IAEEqB,EAAqBX,GAAY,WACrCV,GAAc,EAChB,GAAG,CAACA,IAEEsB,EAAeC,GACnB,iBAAM,MAAC,CACLC,aAAoC,QAAtBC,EAAA7B,eAAAA,EAAeiB,eAAO,IAAAY,OAAA,EAAAA,EAAEC,GACtC5B,gBAAAA,EACAO,mBAAAA,EACAI,eAAAA,EACAQ,gBAAAA,EACAC,mBAAAA,EACAC,oBAAAA,EACAC,kBAAAA,EACAC,mBAAAA,EACA,GACF,CACEzB,EACAE,EACAO,EACAY,EACAE,EACAV,EACAS,EACAE,EACAC,IAIJ,OAAOM,EAAAC,cAACxC,EAAoByC,SAAQ,CAACpC,MAAO6B,GAAe5B,EAC7D,EAEaoC,EAAkB,WAC7B,IAAMC,EAAUC,EAAW5C,GAC3B,IAAK2C,EACH,MAAUE,MAAM,qEAElB,OAAOF,CACT"}
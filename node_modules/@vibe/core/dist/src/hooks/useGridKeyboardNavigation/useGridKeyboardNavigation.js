import{slicedToArray as n}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{useState as e,useRef as i,useContext as t,useCallback as o,useEffect as r}from"react";import{GridKeyboardNavigationContext as u}from"../../components/GridKeyboardNavigationContext/GridKeyboardNavigationContext.js";import a from"../useFullKeyboardListeners.js";import c from"../useEventListener/index.js";import{getActiveIndexFromInboundNavigation as l,calcActiveIndexAfterArrowNavigation as d}from"./gridKeyboardNavigationHelper.js";import{useLastNavigationDirection as s}from"../../components/Menu/Menu/hooks/useLastNavigationDirection.js";var f=-1;function v(v){var m=v.ref,g=v.itemsCount,b=v.numberOfItemsInLine,I=v.onItemClicked,p=v.entryFocusStrategy,x=void 0===p?"directional":p,N=v.getItemByIndex,y=void 0===N?function(n){}:N,O=v.focusOnMount,h=void 0!==O&&O,j=v.focusItemIndexOnMount,A=void 0===j?f:j,C=v.disabledIndexes,L=void 0===C?[]:C,k=v.circularNavigation,K=void 0!==k&&k,M=e(h&&A!==f),S=n(M,2),E=S[0],H=S[1],w=i(!1),B=e(E?A:f),D=n(B,2),F=D[0],G=D[1],_=e(!0),P=n(_,2),R=P[0],T=P[1],q=t(u),z=o((function(){var n;T(!0);var e=L.includes(0)&&g>L.length&&null!==(n=Array.from({length:g},(function(n,e){return e})).find((function(n){return!L.includes(n)})))&&void 0!==n?n:0;G(e)}),[L,g]),J=o((function(){var n;T(!0);var e=L.includes(g-1)&&g>L.length&&null!==(n=Array.from({length:g},(function(n,e){return g-1-e})).find((function(n){return!L.includes(n)})))&&void 0!==n?n:g-1;G(e)}),[L,g]);r((function(){w.current?H(!1):w.current=!0}),[F]);var Q=o((function(){var n;return null===(n=m.current)||void 0===n?void 0:n.blur()}),[m]),U=s().lastNavigationDirectionRef,V=o((function(){if(F===f){var n=U.current;G("directional"===x&&n?l({direction:n,numberOfItemsInLine:b,itemsCount:g}):0),T(!0)}else T(!0)}),[F,x,g,U,b,G,T]),W=o((function(){T(!1)}),[T]),X=o((function(){T(!0),G(f)}),[G]);c({eventName:"focus",callback:V,ref:m}),c({eventName:"mousedown",callback:W,ref:m}),c({eventName:"blur",callback:X,ref:m}),r((function(){var n;F>-1&&(null===(n=m.current)||void 0===n||n.focus())}),[F,m]);var Y=o((function(n){T(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),G(n),I(y(n),n)}),[G,I,y]),Z=o((function(){if(R)return Y(F,!0)}),[R,Y,F]);return a({ref:m,onSelectionKey:Z,onArrowNavigation:function(n){if(T(!0),F!==f){var e=d({activeIndex:F,itemsCount:g,numberOfItemsInLine:b,direction:n,disabledIndexes:L,circularNavigation:K}),i=e.nextIndex;e.isOutbound?null==q||q.onOutboundNavigation(m,n):G(i)}else G(0)},onEscape:Q,onHome:z,onEnd:J,focusOnMount:h}),{activeIndex:R?F:f,onSelectionAction:Y,isInitialActiveState:E}}export{v as default};
//# sourceMappingURL=useGridKeyboardNavigation.js.map

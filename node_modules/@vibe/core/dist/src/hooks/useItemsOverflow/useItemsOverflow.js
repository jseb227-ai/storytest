import{slicedToArray as r}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{useState as n,useRef as e,useCallback as t}from"react";import u from"../ssr/useIsomorphicLayoutEffect.js";function i(i){var c=i.containerRef,o=i.gap,l=i.deductedSpaceRef,f=i.itemRefs,a=n(f.length),s=r(a,2),g=s[0],d=s[1],h=e([]),v=e(0),m=e(!1),p=t((function(){var r=null==c?void 0:c.current;if(r&&f.length){for(var n=r.offsetWidth-v.current,e=0,t=0,u=Math.min(f.length,h.current.length),i=0;u>i;i++){var l=h.current[i],a=i>0?l+o:l;if(e+a>n)break;e+=a,t++}d(t)}else d(f.length)}),[c,f,o]),R=t((function(){v.current=(null==l?void 0:l.current)?l.current.getBoundingClientRect().width:0}),[l]),b=t((function(){m.current||(m.current=!0,requestAnimationFrame((function(){try{if(!c.current||!f.length)return void d(f.length);R();var r=f.map((function(r){return r.current})).filter((function(r){return null!==r}));if(0===r.length)return d(0),void(h.current=[]);h.current=r.map((function(r){return r.getBoundingClientRect().width})),p()}finally{m.current=!1}})))}),[c,f,p,R]);return u((function(){if(c.current){var r=new ResizeObserver((function(){f.length>0?h.current.length?(R(),p()):b():(d(0),h.current=[])}));return r.observe(c.current),(null==l?void 0:l.current)&&r.observe(l.current),function(){return r.disconnect()}}}),[c,l,R,p,b,f]),u((function(){f.length>0?b():(d(0),h.current=[])}),[f,b]),g}export{i as default};
//# sourceMappingURL=useItemsOverflow.js.map
